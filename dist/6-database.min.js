function createIDB(){let e=indexedDB.open("systemm");e.onerror=function(e){console.log("Database error: "+e.target.errorCode)},e.onupgradeneeded=function(e){let t=e.target.result,n=t.createObjectStore("records",{keyPath:"id",autoIncrement:!0});n.createIndex("id","id",{unique:!0}),n.createIndex("theindex","theindex",{unique:!0}),n.createIndex("thetext","thetext",{unique:!1})}}async function openDatabase(){return new Promise((e,t)=>{const n=indexedDB.open("systemm",1);n.onerror=function(e){t(`Failed to open database: ${e.target.errorCode}`)},n.onupgradeneeded=function(e){const t=e.target.result,n=t.createObjectStore("records",{keyPath:"id"});n.createIndex("id","id",{unique:!0}),n.createIndex("theindex","theindex",{unique:!0}),n.createIndex("thetext","thetext",{unique:!1})},n.onsuccess=function(t){const n=t.target.result;e(n)}})}async function dbit(e,t){let n=indexedDB.open("systemm");console.log("xhash"+e),console.log("xall"+t),n.onerror=function(e){console.log("Database error: "+e.target.errorCode)},n.onupgradeneeded=function(e){let t=e.target.result,n=t.createObjectStore("records",{keyPath:"id",autoIncrement:!0});n.createIndex("id","id",{unique:!0}),n.createIndex("theindex","theindex",{unique:!0}),n.createIndex("thetext","thetext",{unique:!1})},n.onsuccess=function(n){let o=n.target.result,r=o.transaction(["records"],"readwrite"),d=r.objectStore("records"),c={theindex:e,thetext:t},a=d.add(c);a.onsuccess=function(e){console.log("Record added to database.")},a.onerror=function(e){console.log("Error adding record to database: "+e.target.errorCode)},r.oncomplete=function(e){o.close()}}}async function getRecords(){const e=await openDatabase(),t=e.transaction("records","readonly"),n=t.objectStore("records"),o=n.index("id"),r=await new Promise((e,t)=>{const n=o.getAll();n.onerror=function(e){t(`Failed to get records: ${e.target.errorCode}`)},n.onsuccess=function(t){e(t.target.result)}});return r}async function displayRecords(){const e=await getRecords(),t=document.getElementById("output");t.innerHTML="",e.forEach(e=>{const n=document.createElement("details"),o=document.createElement("summary"),r=document.createElement("button");o.textContent=e.theindex,r.textContent="DELETE",r.addEventListener("click",async t=>{t.preventDefault();const n=await openDatabase(),o=n.transaction("records","readwrite"),d=o.objectStore("records");d.delete(e.id),o.oncomplete=function(){displayRecords(),r.focus()}});const d=document.createElement("div");d.textContent=e.thetext,d.classList.add("file-list-local"),r.classList.add("del-boy"),r.classList.add("background-color-two"),n.appendChild(o),n.appendChild(r),n.appendChild(d),t.appendChild(n),n.classList.add("d-f"),n.focus()})}createIDB(),displayRecords();