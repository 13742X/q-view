async function copyToClipboard(e){try{document.getElementById("copy-message").classList.remove("hide"),document.getElementById("copy-message").classList.add("show"),await navigator.clipboard.writeText(e),wait(500),document.getElementById("copy-message").classList.remove("show"),document.getElementById("copy-message").classList.add("hide")}catch(e){console.error("Failed to copy text: ",e)}}function checkAndStoreWidth(){window.innerWidth<699&&localStorage.setItem("_view","mobile")}function transitionAfterPageLoad(){document.getElementById("body").classList.remove("no-transition")}function checkURL(){try{var e=window.location.href;if(e.includes("?")){var t=e.split("?")[1];t=atob(t),t=decodeURIComponent(t),t=t.replace("?a=",""),t=t.replace("&b=",","),t=t.replace("&c=",","),t=t.replace("&d=",",");const o=t.split(",");let l,a,c,d;l=o[0].trim(),a=o[1].trim(),c=o[2].trim(),d=o[3].trim();var n="?a="+l+"&b="+a+"&c="+c+"&d="+d;n=encodeURIComponent(n),n=btoa(n),e=e.replace("#",""),localStorage.setItem("link,"+l,e+"?"+n),localStorage.setItem("papName",l),localStorage.setItem("pap",a),localStorage.setItem("logo",d)}}catch(e){console.log("An error occurred:")}}function searchPairsByPrefix(e){var t="";for(let n=0;n<localStorage.length;n++){const o=localStorage.key(n);if(o.startsWith(e)){const e=localStorage.getItem(o),n=o.split(","),l=n[n.length-1];t+="<span class='tag background-color-three font-color-two' id='"+l+"'><a target='popout' href='"+e+"'>"+l+"</a></span> "}}return t}function getShortURL(e){var t=document.getElementById("short-url");t.classList.add("short-url"),fetch(e).then(e=>e.text()).then(e=>{t.value="https://q-viewer.com/u/"+e,t.classList.remove("short-url")}).catch(e=>{t.value="error",console.log("Error fetching webpage:",e)})}function createTheTags(){var e=document.getElementById("i7").value;if(console.log(e),null===e||""===e);else{url=window.location.href,document.getElementById("the-create-message").innerText="",localStorage.setItem("pap",document.getElementById("i1").value),localStorage.setItem("logo",document.getElementById("i6").value),localStorage.setItem("papName",document.getElementById("i7").value),document.getElementById("pname").value=document.getElementById("i7").value,document.getElementById("namer").innerText=document.getElementById("i7").value;var t=e,n=localStorage.getItem("pap"),o="embedded",l=localStorage.getItem("logo"),a="?a="+t+"&b="+n+"&c="+o+"&d="+l;a=encodeURIComponent(a),a=btoa(a),url=url.replace("#",""),localStorage.setItem("link,"+t,url+"?"+a),document.getElementById("pkey").value=a,document.getElementById("short-url").value="";var c=searchPairsByPrefix("link");document.getElementById("tag-container").innerHTML=c,document.getElementById("i7").value=""}const d=document.getElementById("tag-container"),s=d.querySelectorAll(".tag");s.forEach(e=>{const t=document.createElement("span");t.innerHTML="&times;",t.classList.add("delete-button"),t.classList.add("background-color-five"),t.addEventListener("click",()=>{deleteTag(e.id),createDropdownList()}),e.appendChild(t)}),createDropdownList()}function deleteTag(e){const t=document.getElementById(e);t.parentNode.removeChild(t),localStorage.removeItem("link,"+e)}function createDropdownList(){const e=document.getElementById("links-dropdown");e.innerHTML="";const t=Object.keys(localStorage),n=t.filter(e=>e.startsWith("link")),o=[];n.forEach(e=>{const t=localStorage.getItem(e),n=e.slice(5);o.push({title:n,link:t})}),o.sort((e,t)=>e.title.localeCompare(t.title)),o.forEach(t=>{const{title:n,link:o}=t,l=document.createElement("div"),a=document.createElement("a");a.href=o,a.textContent=n,l.appendChild(a),e.appendChild(l)})}function showHiddenDiv(e){hiddenDiv.classList.toggle("hide")}function handleClickOutside(e){hiddenDiv.contains(e.target)||dropdownElement.contains(e.target)||hiddenDiv.classList.add("hide")}window.addEventListener("beforeinstallprompt",e=>{e.preventDefault();const t=document.createElement("button");t.innerText="INSTALL APP",t.classList.add("pwa-button"),t.addEventListener("click",()=>{t.style.display="none",n.style.display="none",e.prompt()});const n=document.createElement("button");n.innerText="USE WEB",n.classList.add("pwa-button"),n.addEventListener("click",()=>{t.style.display="none",n.style.display="none"});const o=document.createElement("div");o.classList.add("install-button-container"),o.appendChild(t),o.appendChild(n),document.body.appendChild(o),console.log("beforeinstallprompt event fired!")});const copyButton=document.getElementById("copyButton"),copyFullButton=document.getElementById("copyFullButton"),copyURLButton=document.getElementById("copyURLButton");copyButton.addEventListener("click",async()=>{var e=document.getElementById("pkey").value;""!=e&&copyToClipboard(e)}),copyURLButton.addEventListener("click",async()=>{var e=document.getElementById("short-url").value;""!=e&&copyToClipboard(e)}),copyFullButton.addEventListener("click",async()=>{var e="https://app.q-viewer.com/?"+document.getElementById("pkey").value;""!=document.getElementById("pkey").value&&copyToClipboard(e)}),addEventListener("touchstart",this.callPassedFuntion,{passive:!1});const mq=window.matchMedia("(min-width: 700px)");if(mq.matches)console.log("desktop"),localStorage.setItem("_view","www");else{var div=document.querySelector(".item2");div.classList.toggle("hide");var element=document.getElementById("thebody");localStorage.setItem("_view","mobile"),element.classList.toggle("col2")}if(window.addEventListener("resize",checkAndStoreWidth),checkAndStoreWidth(),"undefined"!=typeof chrome&&chrome.extension&&chrome.tabs){var settings="<a href='#'>Extension Options</a>";document.getElementById("crxoptions").innerHTML=settings;var obutton=document.getElementById("crxoptions");obutton.onclick=function(){chrome.tabs.create({url:`chrome://extensions/?id=${chrome.runtime.id}`})},chrome.tabs.getCurrent(function(e){if(e){var t=document.getElementById("expand");t.style.display="none";var n=document.getElementById("burgercontainer");n.classList.add("change")}else console.log("crx"),localStorage.setItem("_view","mobile"),display.setAttribute("href","./css/crx-style.min.css")})}else display.setAttribute("href","./css/www-style.min.css");var ssheet="./css/default.min.css",ssheetshort="default.css";theme.setAttribute("href",ssheet),localStorage.getItem("papSheet")?(theme.setAttribute("href","./css/"+localStorage.getItem("papSheet")),document.getElementById("ss").value=localStorage.getItem("papSheet")):(localStorage.setItem("papSheet",ssheetshort),theme.setAttribute("href",ssheet),document.getElementById("ss").value=ssheetshort),transitionAfterPageLoad(),document.getElementById("refresher").classList.remove("hide"),document.getElementById("the-options").classList.add("icon-hide"),document.getElementById("the-sandbox").classList.add("icon-hide"),document.getElementById("setting-items").classList.add("hide"),checkURL();try{var linko=searchPairsByPrefix("link");document.getElementById("tag-container").innerHTML=linko}catch{}var cbutton=document.getElementById("createlink");cbutton.onclick=function(){""!=document.getElementById("i7").value&&createTheTags()};var ubutton=document.getElementById("createURL");ubutton.onclick=function(){if(""!=document.getElementById("pkey").value){var e="https://q-viewer.com/api/url?l="+document.getElementById("pkey").value+"&y=1";console.log(e),getShortURL(e)}};const textBox=document.getElementById("i7");textBox.addEventListener("keydown",function(e){const t=e.key,n=/^[a-zA-Z0-9\s\b]+$/.test(t);n||e.preventDefault()}),textBox.addEventListener("paste",function(e){e.preventDefault()}),createTheTags();var impbutton=document.getElementById("importlink");impbutton.onclick=function(){try{var e=document.getElementById("imp1").value;e=atob(e),e=decodeURIComponent(e),e=e.replace("?a=",""),e=e.replace("&b=",","),e=e.replace("&c=",","),e=e.replace("&d=",",");const n=e.split(",");let o,l,a,c;o=n[0].trim(),l=n[1].trim(),a=n[2].trim(),c=n[3].trim();var t="?a="+o+"&b="+l+"&c="+a+"&d="+c;t=encodeURIComponent(t),t=btoa(t),url=window.location.href,url=url.replace("#",""),localStorage.setItem("link,"+o,url+"?"+t),localStorage.setItem("pap",l),localStorage.setItem("logo",c),url+="?"+t,document.getElementById("create-message").innerText="Success. Reload to view these files."}catch{console.log("Failed to decode the import..."),document.getElementById("create-message").innerText="Import did not work. Try again."}};var pk=url=window.location.href;if(pk.includes("?")&&!pk.includes("&")){const e=pk.split("?"),t=e[e.length-1];document.getElementById("pkey").value=t,copyButton.classList.add("show"),copyFullButton.classList.add("show"),copyURLButton.classList.add("show");var thisname=localStorage.getItem("papName");document.getElementById("pname").value=thisname}else document.getElementById("pkey").value="";createDropdownList();const dropdownElement=document.getElementById("linkviews"),hiddenDiv=document.getElementById("links-dropdown");dropdownElement.addEventListener("click",showHiddenDiv),document.addEventListener("click",handleClickOutside);